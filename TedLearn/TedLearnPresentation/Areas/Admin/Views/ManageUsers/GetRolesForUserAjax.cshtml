@using Services.DTOs.AdminPanel.Role;
@model GetRolesForUserDto

@foreach (var userHasRole in Model.UserIsInRoles)
{
    <tr>
        <td class="p-2 align-middle bg-transparent border-b dark:border-white/40 whitespace-nowrap shadow-transparent">
            <h6 class="mb-0 text-sm leading-normal dark:text-white">@userHasRole.RoleName</h6>
        </td>
        <td class="p-2 py-20px align-middle flex justify-center bg-transparent border-b dark:border-white/40 whitespace-nowrap shadow-transparent">
            @if (userHasRole.RoleName == "مدیر سایت" || userHasRole.RoleName == "کاربر عادی")
            {
                <p class="text-sm m-0">این نقش قابل حذف نیست.</p>
            }
            else
            {
                <form id="form-info" method="post" asp-controller="ManageUsers" asp-action="DeleteRoleFromUser" asp-route-roleId="@userHasRole.RoleId" asp-route-userId="@userHasRole.UserId">
                    @Html.AntiForgeryToken()
                    <button type="button" class="text-xs rounded-lg py-2 px-4 bg-slate-100 font-semibold leading-tight dark:text-white dark:opacity-80 text-slate-400"> حذف نقش </button>
                </form>
            }
        </td>
    </tr>
}

@foreach (var userHasNotRole in Model.UserIsNotInRoles)
{
    <tr>
        <td class="p-2 align-middle bg-transparent border-b dark:border-white/40 whitespace-nowrap shadow-transparent">
            <h6 class="mb-0 text-sm leading-normal dark:text-white">@userHasNotRole.RoleName</h6>
        </td>
        <td class="p-2 py-20px align-middle flex justify-center bg-transparent border-b dark:border-white/40 whitespace-nowrap shadow-transparent">
            <form id="form-info" method="post" asp-controller="ManageUsers" asp-action="AddRoleToUser" asp-route-roleId="@userHasNotRole.RoleId" asp-route-userId="@userHasNotRole.UserId">
                @Html.AntiForgeryToken()
                <button type="button" class="text-xs rounded-lg py-2 px-4 bg-slate-100 font-semibold leading-tight dark:text-white dark:opacity-80 text-slate-400"> اضافه کردن نقش </button>
            </form>
        </td>
    </tr>
}

@if (TempData.ContainsKey("ResultOfAddRoleToUser"))
{
    var result = TempData["ResultOfAddRoleToUser"];
    @TempData.Remove("ResultOfAddRoleToUser")
    ;

    @if (result != null)
    {
        @if (result.ToString() == "SqlExeption")
        {
            <script type="text/javascript">
                $("#info").empty().append('< div id = "Bg-Navbar-Black" class= "overflow-hidden flex justify-center items-center w-full h-full fixed bg-black bg-opacity-50 top-0 right-0" ><div id="notice" class= "scale-up-center w-64 bg-slate-100 rounded-md p-2" ><div class="w-full h-24 flex justify-center items-center" ><span><i class="fa fa-warning text-6xl text-red-500" > </i></span ></div>< div class= "w-full h-auto" ><h1 class="font-semibold text-lg text-center" > خطای ناشناخته < /h1>< p class= "text-sm text-center mt-2" >متاسفانه خطایی سمت سرور رخ داده است.لطفا بعدا امتحان کنید.< /p>< /div>< div class= "w-full h-12 flex justify-center items-end" ><button id="ok" class= "w-16 h-8 bg-red-500 text-slate-50 text-sm rounded-md" type = "button" > فهمیدم < /button>< /div></div>< /div>');
                $('<script>$("#ok").click(function () {$("#notice").addClass("scale-down-center");setTimeout(function() { $("#Bg-Navbar-Black").addClass("hidden"); }, 70);});$("#Bg-Navbar-Black").click(function() { $("#notice").addClass("scale-down-center");setTimeout(function() { $("#Bg-Navbar-Black").addClass("hidden"); }, 70);}); </' + 'script>').appendTo('#info');
            </script>
        }

        @if (result.ToString() == "AppOrTimeOutExeption")
        {
            <script type="text/javascript">
                $("#info").empty().append('<div id="Bg-Navbar-Black" class="z-[1001] overflow-hidden flex justify-center items-center w-full h-full fixed bg-black bg-opacity-50 top-0 right-0"><div id="notice" class="scale-up-center w-64 bg-slate-100 rounded-md p-2"><div class="w-full h-24 flex justify-center items-center"><span><i class="fa fa-warning text-6xl text-red-500"></i></span></div><div class="w-full h-auto"><h1 class="font-semibold text-lg text-center">عملیات ناموفق</h1><p class="text-sm text-center mt-2">درخواست شما انجام نشد.لطفا چند دقیقه ی دیگر امتحان کنید.</p></div><div class="w-full h-12 flex justify-center items-end"><button id="ok" class="w-16 h-8 bg-red-500 text-slate-50 text-sm rounded-md" type="button">فهمیدم</button></div></div></div>');
                $('<script>$("#ok").click(function () {$("#notice").addClass("scale-down-center");setTimeout(function() { $("#Bg-Navbar-Black").addClass("hidden"); }, 70);});$("#Bg-Navbar-Black").click(function() { $("#notice").addClass("scale-down-center");setTimeout(function() { $("#Bg-Navbar-Black").addClass("hidden"); }, 70);}); </' + 'script>').appendTo('#info');
            </script>
        }
    }
}

@if (TempData.ContainsKey("ResultOfDeleteRoleFromUser"))
{
    var result = TempData["ResultOfDeleteRoleFromUser"];
    @TempData.Remove("ResultOfDeleteRoleFromUser")
    ;

    @if (result != null)
    {
        @if (result.ToString() == "SqlExeption")
        {
            <script type="text/javascript">
                $("#info").empty().append('< div id = "Bg-Navbar-Black" class= "overflow-hidden flex justify-center items-center w-full h-full fixed bg-black bg-opacity-50 top-0 right-0" ><div id="notice" class= "scale-up-center w-64 bg-slate-100 rounded-md p-2" ><div class="w-full h-24 flex justify-center items-center" ><span><i class="fa fa-warning text-6xl text-red-500" > </i></span ></div>< div class= "w-full h-auto" ><h1 class="font-semibold text-lg text-center" > خطای ناشناخته < /h1>< p class= "text-sm text-center mt-2" >متاسفانه خطایی سمت سرور رخ داده است.لطفا بعدا امتحان کنید.< /p>< /div>< div class= "w-full h-12 flex justify-center items-end" ><button id="ok" class= "w-16 h-8 bg-red-500 text-slate-50 text-sm rounded-md" type = "button" > فهمیدم < /button>< /div></div>< /div>');
                $('<script>$("#ok").click(function () {$("#notice").addClass("scale-down-center");setTimeout(function() { $("#Bg-Navbar-Black").addClass("hidden"); }, 70);});$("#Bg-Navbar-Black").click(function() { $("#notice").addClass("scale-down-center");setTimeout(function() { $("#Bg-Navbar-Black").addClass("hidden"); }, 70);}); </' + 'script>').appendTo('#info');
            </script>
        }

        @if (result.ToString() == "AppOrTimeOutExeption")
        {
            <script type="text/javascript">
                $("#info").empty().append('<div id="Bg-Navbar-Black" class="z-[1001] overflow-hidden flex justify-center items-center w-full h-full fixed bg-black bg-opacity-50 top-0 right-0"><div id="notice" class="scale-up-center w-64 bg-slate-100 rounded-md p-2"><div class="w-full h-24 flex justify-center items-center"><span><i class="fa fa-warning text-6xl text-red-500"></i></span></div><div class="w-full h-auto"><h1 class="font-semibold text-lg text-center">عملیات ناموفق</h1><p class="text-sm text-center mt-2">درخواست شما انجام نشد.لطفا چند دقیقه ی دیگر امتحان کنید.</p></div><div class="w-full h-12 flex justify-center items-end"><button id="ok" class="w-16 h-8 bg-red-500 text-slate-50 text-sm rounded-md" type="button">فهمیدم</button></div></div></div>');
                $('<script>$("#ok").click(function () {$("#notice").addClass("scale-down-center");setTimeout(function() { $("#Bg-Navbar-Black").addClass("hidden"); }, 70);});$("#Bg-Navbar-Black").click(function() { $("#notice").addClass("scale-down-center");setTimeout(function() { $("#Bg-Navbar-Black").addClass("hidden"); }, 70);}); </' + 'script>').appendTo('#info');
            </script>
        }
    }
}

<script asp-append-version="true" src="/AdminStyles/js/ManageUsers/GetRolesForUser.js"></script>
